# 배포 완전 체크리스트

전체 배포와 관련된 모든 설정 사항을 확인할 수 있는 체크리스트입니다.

---

## 📋 필수 설정 (반드시 해야 함)

### 1. Firebase Admin SDK 환경 변수

**로컬 (`.env.local`)**
- [x] `FIREBASE_SERVICE_ACCOUNT_JSON` 설정됨 (확인됨)

**Vercel 환경 변수**
- [ ] `FIREBASE_SERVICE_ACCOUNT_JSON` 추가 여부 확인 필요
  - Vercel 대시보드 → Settings → Environment Variables
  - `.env.local`과 동일한 값으로 설정
  - **Environment**: "All Environments" 선택
  - 설정 후 **Redeploy** 필요

**확인 방법:**
- Vercel 대시보드에서 환경 변수 목록 확인
- 배포 후 업무 생성/수정이 동작하는지 테스트

---

### 2. Firebase 승인된 도메인

- [ ] Firebase 콘솔 → Authentication → Settings → Authorized domains
- [ ] 배포된 Vercel 도메인 추가
  - 예: `your-app.vercel.app` (https:// 없이 도메인만)
  - 로컬 테스트용: `localhost` (이미 있을 수 있음)

**확인 방법:**
- [Firebase 콘솔](https://console.firebase.google.com/project/schedule-checker-b0eb7/authentication/settings)에서 확인

---

### 3. Firestore 규칙 배포

- [ ] Firestore 규칙이 배포되었는지 확인

**방법 A: Firebase CLI**
```bash
cd "/Volumes/Samsung USB/schedule_checker"
npm run firestore:deploy
```

**방법 B: Firebase 콘솔**
1. [Firebase 콘솔](https://console.firebase.google.com/project/schedule-checker-b0eb7/firestore/rules) → Firestore Database → 규칙
2. `firestore.rules` 파일 내용 복사 후 붙여넣기
3. **게시** 클릭

**확인 방법:**
- Firebase 콘솔에서 규칙이 최신 내용과 일치하는지 확인

---

## 🔔 선택 설정 (기능 사용 시 필요)

### 4. Slack 알림 연동

**로컬 (`.env.local`)**
- [x] `SLACK_WEBHOOK_URL` 설정됨 (확인됨)

**Vercel 환경 변수**
- [ ] `SLACK_WEBHOOK_URL` 추가 여부 확인 필요
  - Vercel 대시보드 → Settings → Environment Variables
  - `.env.local`과 동일한 값으로 설정
  - 설정 후 **Redeploy** 필요

**Slack Webhook 설정 (아직 안 했다면)**
1. [Slack API](https://api.slack.com/apps) → Create New App → From scratch
2. 앱 이름·워크스페이스 선택
3. Incoming Webhooks → On → Add New Webhook to Workspace
4. 알림 받을 채널 선택 후 Webhook URL 복사
5. 환경 변수에 추가

**확인 방법:**
- 지연 감지 알림 또는 데일리 요약이 Slack 채널로 전송되는지 확인

---

### 5. Google Calendar 연동

**Vercel 환경 변수**
- [ ] `GOOGLE_CALENDAR_CLIENT_ID` 추가 여부 확인 필요
- [ ] `GOOGLE_CALENDAR_CLIENT_SECRET` 추가 여부 확인 필요

**Google Cloud Console 설정 (아직 안 했다면)**
1. [Google Cloud Console](https://console.cloud.google.com/) → 프로젝트 선택
2. **API 및 서비스** → **사용자 인증 정보** → **사용자 인증 정보 만들기** → **OAuth 클라이언트 ID**
3. 애플리케이션 유형: **웹 애플리케이션**
4. **승인된 리디렉션 URI** 추가:
   - 로컬: `http://localhost:4000/api/integrations/google-calendar/callback`
   - 배포: `https://your-app.vercel.app/api/integrations/google-calendar/callback`
5. **클라이언트 ID**와 **클라이언트 시크릿** 복사
6. 환경 변수에 추가
7. **API 및 서비스** → **라이브러리** → **Google Calendar API** 검색 후 **사용** 설정

**확인 방법:**
- 설정 페이지에서 "Google Calendar 연동" 섹션이 보이는지 확인
- "Google 계정으로 연동" 버튼 클릭 시 정상 작동하는지 확인

---

## ⏰ 자동화 설정

### 6. Vercel Cron Jobs

**설정 확인**
- [x] `vercel.json` 파일에 Cron 설정 있음 (확인됨)
- [x] 스케줄: `0 0 * * *` (매일 09:00 KST) (확인됨)

**Vercel 대시보드 확인**
- [ ] Vercel 대시보드 → Settings → Cron Jobs
- [ ] "Enabled" 토글이 켜져 있는지 확인
- [ ] 배포 완료 후 Cron Jobs 목록에 등록되었는지 확인
  - Path: `/api/automation/daily-summary`
  - Schedule: `0 0 * * *`
  - Status: Active

**확인 방법:**
1. Vercel 대시보드 → Deployments 탭에서 최신 배포 완료 확인
2. Settings → Cron Jobs 페이지에서 등록된 Cron 확인
3. Functions → `/api/automation/daily-summary` → Logs에서 실행 기록 확인

---

## 🚀 배포 상태 확인

### 7. 최신 배포 확인

- [ ] Vercel 대시보드 → Deployments 탭
- [ ] 최신 배포가 "Ready" 상태인지 확인
- [ ] 최신 커밋이 반영되었는지 확인

**배포가 안 되어 있다면:**
- Git에 푸시되어 있는지 확인
- Vercel에서 자동 배포가 트리거되었는지 확인
- 필요 시 수동으로 "Redeploy" 실행

---

## ✅ 기능별 동작 확인

### 8. 핵심 기능 테스트

**업무 관리**
- [ ] 새 업무 생성
- [ ] 업무 수정
- [ ] 업무 삭제
- [ ] 업무 목록 조회

**로그인/인증**
- [ ] Google 로그인
- [ ] 로그아웃
- [ ] 인증 상태 유지

**설정 페이지**
- [ ] 테마 변경
- [ ] Google Calendar 연동 섹션 표시 확인
- [ ] 기타 설정 저장

**Google Calendar (설정한 경우)**
- [ ] OAuth 연동 완료
- [ ] 업무 생성 시 캘린더 이벤트 생성 확인
- [ ] 업무 수정 시 캘린더 이벤트 업데이트 확인

**Slack 알림 (설정한 경우)**
- [ ] 지연 감지 알림 수신 확인
- [ ] 데일리 요약 알림 수신 확인

**Cron Jobs (설정한 경우)**
- [ ] 매일 09:00에 데일리 요약 자동 실행 확인
- [ ] Functions Logs에서 실행 기록 확인

---

## 📝 현재 상태 요약

### ✅ 완료된 항목
- [x] Firebase Admin SDK 로컬 환경 변수 설정
- [x] Slack Webhook 로컬 환경 변수 설정
- [x] `vercel.json` Cron 설정
- [x] Git 푸시 및 코드 배포

### ⚠️ 확인 필요한 항목
- [ ] Vercel 환경 변수 설정 (FIREBASE_SERVICE_ACCOUNT_JSON, SLACK_WEBHOOK_URL, GOOGLE_CALENDAR_CLIENT_ID, GOOGLE_CALENDAR_CLIENT_SECRET)
- [ ] Firebase 승인된 도메인 추가
- [ ] Firestore 규칙 배포
- [ ] Vercel Cron Jobs 등록 확인
- [ ] Google Cloud Console OAuth 설정 (Google Calendar 사용 시)

---

## 🔍 빠른 확인 명령어

**로컬 환경 변수 확인:**
```bash
cd "/Volumes/Samsung USB/schedule_checker"
cat .env.local | grep -E "^[A-Z_]+=" | cut -d'=' -f1
```

**Firestore 규칙 배포:**
```bash
npm run firestore:deploy
```

**Git 상태 확인:**
```bash
git status
```

---

## 📚 관련 문서

- `docs/DEPLOY-CHECKLIST.md` - 기본 배포 체크리스트
- `docs/선택기능-진행가이드.md` - 선택 기능 설정 가이드
- `docs/Cron-Job-확인-가이드.md` - Cron Job 확인 방법

---

## 💡 다음 단계

1. **Vercel 환경 변수 설정** (가장 중요!)
2. **Firebase 승인된 도메인 추가**
3. **Firestore 규칙 배포**
4. **배포 후 기능 테스트**
5. **Cron Jobs 등록 확인**

위 항목들을 순서대로 진행하시면 됩니다.
