# 환경 변수 설정 후 확인 가이드

## 완료된 작업
- [x] `FIREBASE_PROJECT_ID` 추가
- [x] `FIREBASE_CLIENT_EMAIL` 추가
- [x] `FIREBASE_PRIVATE_KEY` 추가

---

## 다음 단계

### 1단계: FIREBASE_SERVICE_ACCOUNT_JSON 확인

**중요:** 두 가지 방식을 동시에 사용하면 충돌할 수 있습니다.

**확인 사항:**
- [ ] `FIREBASE_SERVICE_ACCOUNT_JSON`이 있으면 삭제하거나 비활성화
- [ ] 또는 3개 환경 변수만 사용하도록 확인

**권장:** `FIREBASE_SERVICE_ACCOUNT_JSON` 삭제 (3개 환경 변수만 사용)

---

### 2단계: Redeploy 실행

1. Vercel 대시보드 → **Deployments** 탭
2. 최신 배포 클릭
3. **Redeploy** 버튼 클릭
4. 또는 Settings → Environment Variables에서 저장 후 자동 배포 대기

**배포 완료까지:** 보통 2-5분 소요

---

### 3단계: 함수 테스트

**방법 1: 브라우저에서 직접 호출**
```
https://autoflow-sepia.vercel.app/api/automation/daily-summary
```

**방법 2: Vercel 대시보드에서**
1. Functions → `/api/automation/daily-summary` 클릭
2. **Invoke** 또는 **Test** 버튼 클릭

**예상되는 정상 응답:**
```json
{
  "success": true,
  "summary": "오늘 완료율: 0% | 지연 위험: 0건 | 총 업무: 0건"
}
```

---

### 4단계: Logs 확인

1. Functions → `/api/automation/daily-summary` → **Logs** 탭
2. 확인 사항:
   - [ ] `Firebase Admin init skipped` Warning이 사라졌는지
   - [ ] `Firebase Admin이 초기화되지 않았습니다` 오류가 사라졌는지
   - [ ] 함수가 정상 작동하는지

---

## 문제 해결

### 여전히 오류가 발생하는 경우

**1. 환경 변수 값 확인**
- `FIREBASE_PROJECT_ID`: `schedule-checker-b0eb7`
- `FIREBASE_CLIENT_EMAIL`: `firebase-adminsdk-fbsvc@schedule-checker-b0eb7.iam.gserviceaccount.com`
- `FIREBASE_PRIVATE_KEY`: `-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n`

**2. FIREBASE_SERVICE_ACCOUNT_JSON 확인**
- 삭제했는지 확인
- 있으면 삭제하고 재배포

**3. Logs에서 상세 오류 확인**
- Functions → Logs에서 정확한 오류 메시지 확인

---

## 체크리스트

- [ ] 3개 환경 변수 추가 완료
- [ ] `FIREBASE_SERVICE_ACCOUNT_JSON` 삭제 또는 비활성화
- [ ] Redeploy 실행
- [ ] 배포 완료 대기
- [ ] 함수 테스트
- [ ] Logs에서 오류 확인
- [ ] 정상 작동 확인

---

## 예상 결과

환경 변수가 올바르게 설정되면:
- ✅ Firebase Admin SDK 정상 초기화
- ✅ `/api/automation/daily-summary` 함수 정상 작동
- ✅ Cron Job도 정상 작동 (다음 09:00 KST에 실행)

---

## 다음 실행 시간

- **Cron Job 첫 실행**: 다음 09:00 (한국 시간)
- **수동 테스트**: 지금 바로 가능
